<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Tian Workshop CMS</title>
  
  <style>
    body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif; }
    #loading-msg { text-align: center; margin-top: 50px; color: #666; }
  </style>

  <!-- 1. å‘Šè¯‰ CMS æˆ‘ä»¬è¦æ‰‹åŠ¨åˆå§‹åŒ– (å¿…é¡»åœ¨è„šæœ¬åŠ è½½å‰ï¼) -->
  <script>window.CMS_MANUAL_INIT = true;</script>
  
  <!-- 2. åŠ è½½ CMS è„šæœ¬ (ä½¿ç”¨ unpkg çš„ç¨³å®šç‰ˆ) -->
  <script src="https://unpkg.com/decap-cms@^3.1.0/dist/decap-cms.js"></script>
</head>
<body>
  <div id="loading-msg">Loading Tian Workshop CMS... ğŸ—ï¸</div>

  <script>
    // 3. ç­‰å¾…è„šæœ¬åŠ è½½å®Œæˆåï¼Œæ‰‹åŠ¨åˆå§‹åŒ–
    // ä½¿ç”¨è½®è¯¢ç¡®ä¿ CMS å¯¹è±¡å­˜åœ¨
    var checkCMS = setInterval(function() {
      if (window.CMS) {
        clearInterval(checkCMS);
        document.getElementById('loading-msg').style.display = 'none';
        
        console.log("Starting CMS manual init...");
        
        window.CMS.init({
          config: {
            backend: {
              name: 'github',
              repo: 'wu-tian807/tianworkshop',
              branch: 'main',
              base_url: 'https://tianworkshop.cn',
              auth_endpoint: 'api/auth',
              squash_merges: true
            },
            media_folder: "assets/uploads",
            public_folder: "/assets/uploads",
            collections: [
              {
                name: "master_log",
                label: "Master's Logs",
                folder: "logs/master",
                create: true,
                slug: "{{year}}-{{month}}-{{day}}-{{slug}}",
                fields: [
                  {label: "Title", name: "title", widget: "string"},
                  {label: "Publish Date", name: "date", widget: "datetime"},
                  {label: "Body", name: "body", widget: "markdown"}
                ]
              },
              {
                name: "niangao_log",
                label: "Niangao's Logs",
                folder: "logs/niangao",
                create: true,
                slug: "{{year}}-{{month}}-{{day}}-{{slug}}",
                fields: [
                  {label: "Title", name: "title", widget: "string"},
                  {label: "Publish Date", name: "date", widget: "datetime"},
                  {label: "Mood", name: "mood", widget: "select", options: ["ğŸŒŸ", "ğŸµ", "ğŸ’»", "â¤ï¸", "ğŸ’¤", "ğŸ”¥", "ğŸ”"]},
                  {label: "Body", name: "body", widget: "markdown"}
                ]
              }
            ]
          }
        });
      }
    }, 100); // æ¯ 100ms æ£€æŸ¥ä¸€æ¬¡
  </script>
</body>
</html>